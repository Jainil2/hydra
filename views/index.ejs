<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Hydra Playground</title>
  </head>
  <body>
  <%- include('partials/header', { user: user }) %>
    <h1>Hydra Playground</h1>
    <ul>
      <li><a href="/demo/well-known">/.well-known/openid-configuration</a></li>
      <li><a href="/demo/jwks">/.well-known/jwks.json</a></li>
    </ul>
    <h2>Flows</h2>
    <p>Use the authorize endpoint of your client to start flows. Example authorize URL:</p>
    <pre id="example"></pre>
    <script>
      const pub = "<%= env.HYDRA_PUBLIC_URL || 'http://localhost:4444' %>";
      const client = encodeURIComponent('<your-client-id>');
      const redirect = encodeURIComponent('http://localhost:3000/result');
      // generate a sufficiently long random string for state and nonce (minimum 8 chars required by Hydra)
      function randomString(len = 12) {
        return Array.from(crypto.getRandomValues(new Uint8Array(len)))
          .map(n => (n % 36).toString(36))
          .join('');
      }
      const state = randomString(12);
      const nonce = randomString(12);
      document.getElementById('example').innerText = pub + '/oauth2/auth?response_type=code&scope=openid%20offline&client_id=' + client + '&redirect_uri=' + redirect + '&state=' + encodeURIComponent(state) + '&nonce=' + encodeURIComponent(nonce);
    </script>
    <p><a href="/flows">Open Flow Runner (demo UI)</a></p>
  </body>
</html>
